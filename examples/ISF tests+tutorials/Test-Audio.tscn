[gd_scene load_steps=3 format=3 uid="uid://cmgclbh1t2v0l"]

[sub_resource type="Shader" id="Shader_lki5u"]
code = "// Godot Shader generated from ISF (Interactive Shader Format)

shader_type canvas_item;

#include \"res://addons/godot-isf/include/ISF.gdshaderinc\"


// INPUTS 
uniform sampler2D waveImage : source_color;
uniform float waveSize;
uniform bool stereo;


// IMPORTED 


// PASSES 


/*
{
  \"CATEGORIES\" : [
    \"Generator\"
  ],
  \"DESCRIPTION\" : \"Visualizes an FFT analysis image with custom set colors for frequency domain\",
  \"INPUTS\" : [
    {
      \"NAME\" : \"waveImage\",
      \"TYPE\" : \"audio\"
    },
    {
      \"NAME\" : \"waveSize\",
      \"TYPE\" : \"float\",
      \"MAX\" : 0.5,
      \"DEFAULT\" : 0.05,
      \"MIN\" : 0
    },
    {
      \"NAME\" : \"stereo\",
      \"TYPE\" : \"bool\",
      \"DEFAULT\" : 1
    }
  ],
  \"CREDIT\" : \"by VIDVOX\"
}
*/



void main() {
	
	vec2		loc = vec2(vv_FragNormCoord[1], vv_FragNormCoord[0]);
	
	vec2		rawSize = IMG_SIZE(waveImage);
	float		channel = 0.5;
	float		offset = 0.0;
	if (stereo == true)	{
		channel = (loc.x > 0.5) ? 0.0 : 1.0;
		offset = (loc.x > 0.5) ? 0.25 : -0.25;
	}
	
	vec2		waveLoc = vec2(loc.y,channel);
	vec4		wave = IMG_NORM_PIXEL(waveImage, waveLoc)+offset;
	vec4		waveAdd = (1.0 - smoothstep(0.0, waveSize, abs(wave - loc.x)));
	waveAdd.a = 1.0;
	gl_FragColor = waveAdd;
}"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_omvn5"]
resource_local_to_scene = true
shader = SubResource("Shader_lki5u")
shader_parameter/waveSize = 0.05
shader_parameter/stereo = false

[node name="" type="ColorRect"]
material = SubResource("ShaderMaterial_omvn5")
anchor_right = 1.0
anchor_bottom = 1.0
offset_right = 1280.0
offset_bottom = 720.0
