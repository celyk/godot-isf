[gd_scene load_steps=5 format=3 uid="uid://dpdb1u5l2sv6q"]

[ext_resource type="Script" uid="uid://dxbaw52rtcbft" path="res://addons/godot-isf/render/ISFRenderPass.gd" id="1_s8x2a"]

[sub_resource type="Shader" id="Shader_b47lr"]
code = "// Godot Shader generated from ISF (Interactive Shader Format)

shader_type canvas_item;

#include \"res://addons/godot-isf/include/ISF.gdshaderinc\"


// INPUTS 
uniform sampler2D inputImage : source_color;
uniform float blurAmount;


// IMPORTED 


// PASSES 
uniform sampler2D bufferVariableNameA : source_color;


/*{
	\"DESCRIPTION\": \"demonstrates the use of a persistent buffer to create a motion-blur type effect. also demonstrates the simplest use of steps: a one-step rendering pass\",
	\"CREDIT\": \"by zoidberg\",
	\"ISFVSN\": \"2.0\",
	\"CATEGORIES\": [
		\"TEST-GLSL FX\"
	],
	\"INPUTS\": [
		{
			\"NAME\": \"inputImage\",
			\"TYPE\": \"image\"
		},
		{
			\"NAME\": \"blurAmount\",
			\"TYPE\": \"float\"
		}
	],
	\"PASSES\": [
		{
			\"TARGET\": \"bufferVariableNameA\",
			\"PERSISTENT\": true,
			\"FLOAT\": true
		}
	]
	
}*/

void main()
{
	vec4		freshPixel = IMG_THIS_PIXEL(inputImage);
	vec4		stalePixel = IMG_THIS_PIXEL(bufferVariableNameA);
	gl_FragColor = mix(freshPixel,stalePixel,blurAmount);
}
"

[sub_resource type="ViewportTexture" id="ViewportTexture_7pgxn"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_7gr1x"]
resource_local_to_scene = true
shader = SubResource("Shader_b47lr")
shader_parameter/blurAmount = 0.0
shader_parameter/bufferVariableNameA = SubResource("ViewportTexture_7pgxn")

[node name="" type="ColorRect"]
material = SubResource("ShaderMaterial_7gr1x")
instance_shader_parameters/PASSINDEX = 1
anchor_right = 1.0
anchor_bottom = 1.0
offset_right = 1280.0
offset_bottom = 720.0

[node name="BufferVariableNameA" type="SubViewport" parent="."]
size = Vector2i(2, 2)
render_target_update_mode = 4
script = ExtResource("1_s8x2a")
material = SubResource("ShaderMaterial_7gr1x")
persistent = true
target = "bufferVariableNameA"
